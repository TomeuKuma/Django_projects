<!-- templates/examinador/pregunta.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pregunta</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
    <style>
        body {
            background-color: #f8f4fc; /* Fondo pastel */
            color: #3c3c3c; /* Texto neutro */
        }
        .card {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn {
            border-radius: 25px;
        }
        .btn-primary {
            background-color: #a4c8e1; /* Azul pastel */
            border-color: #7caad0;
        }
        .btn-primary:hover {
            background-color: #7caad0;
            border-color: #6498be;
        }
        .btn-secondary {
            background-color: #f3a6a2; /* Rosa pastel */
            border-color: #f09792;
        }
        .btn-secondary:hover {
            background-color: #f09792;
            border-color: #e88783;
        }
        .container {
            margin-top: 50px;
        }
        #temporizador {
            font-size: 1.2rem;
            font-weight: bold;
            color: #7a7a7a;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card p-4">
            <!-- Temporizador -->
            <div id="temporizador" class="text-center">Tiempo: 00:00</div>
            <!-- Pregunta -->
            <h6 class="text-center">{{ pregunta.pregunta }}</h6>
            <form id="respuestaForm" class="my-4">
                <input type="hidden" name="pregunta_id" value="{{ pregunta.id }}">
                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" name="respuesta" value="1" id="respuesta1">
                    <label class="form-check-label" for="respuesta1">{{ pregunta.respuesta1 }}</label>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" name="respuesta" value="2" id="respuesta2">
                    <label class="form-check-label" for="respuesta2">{{ pregunta.respuesta2 }}</label>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" name="respuesta" value="3" id="respuesta3">
                    <label class="form-check-label" for="respuesta3">{{ pregunta.respuesta3 }}</label>
                </div>
                <div class="form-check mb-4">
                    <input class="form-check-input" type="radio" name="respuesta" value="4" id="respuesta4">
                    <label class="form-check-label" for="respuesta4">{{ pregunta.respuesta4 }}</label>
                </div>
            </form>
            <!-- Botones -->
            <div class="d-flex justify-content-between">
                <button class="btn btn-primary" onclick="anteriorPregunta()">Anterior</button>
                <button class="btn btn-primary" onclick="comprobarRespuesta()">Comprobar</button>
                <button class="btn btn-primary" onclick="siguientePregunta()">Siguiente</button>
            </div>
            <div class="d-flex justify-content-between">
                <button class="btn btn-secondary" onclick="irConfiguracion()">Ir a Configuración</button>
                <button class="btn btn-secondary" onclick="irResultados()">Finalizar</button>
            </div>
            <!-- Feedback -->
            <div id="feedback" class="alert mt-4 d-none"></div>
        </div>
    </div>

    <script>
    // Mostrar el temporizador
    const startTime = new Date('{{ request.session.hora_inicio }}'); // Hora de inicio del examen desde la sesión
    function updateTimer() {
        const now = new Date();
        const diff = new Date(now - startTime);
        const minutes = String(diff.getMinutes()).padStart(2, '0');
        const seconds = String(diff.getSeconds()).padStart(2, '0');
        document.getElementById('temporizador').textContent = `Tiempo transcurrido: ${minutes}:${seconds}`;
    }
    setInterval(updateTimer, 1000); // Actualizar cada segundo

    // Función para retroceder
    function anteriorPregunta() {
        window.location.href = '/examinador/anterior/';
    }

    // Función para comprobar la respuesta
    function comprobarRespuesta() {
        const form = document.getElementById('respuestaForm');
        const formData = new FormData(form);
        fetch('/examinador/comprobar/', {
            method: 'POST',
            body: formData,
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
            },
        })
        .then(response => response.json())
        .then(data => {
            const feedback = document.getElementById('feedback');
            feedback.classList.remove('d-none', 'alert-danger', 'alert-success');
            feedback.classList.add(data.es_correcta ? 'alert-success' : 'alert-danger');
            feedback.textContent = data.es_correcta
                ? `Correcto: ${data.justificacion}`
                : `Incorrecto: ${data.justificacion}`;
        });
    }

    // Función para avanzar a la siguiente pregunta
    function siguientePregunta() {
        window.location.href = '/examinador/siguiente/';
    }

    // Función para volver al menú configuración
    function irConfiguracion() {
        window.location.href = '/examinador/';
    }

    // Función para acabar el examen e ir a resultados
    function irResultados() {
        window.location.href = '/examinador/resultados/';
    }
    </script>
</body>
</html>
